{
  "hash": "45af3c725a74fb044b01e2e0188b9223",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Using Complex Bayesian Hierarchical Models for \"Detection\" with Count Data'\nauthor: \"Ben Brintz\"\ninstitute: \"IDEAS / VA\"\nformat:\n  revealjs:\n    theme: white\n    transition: fade\n    autoAnimateDuration: 1.25\n    autoAnimateEasing: linear\n    auto-animate-unmatched: false\n    incremental: true\n    slideNumber: true\n    include-after-body: slide-number-fix.html\n    css: [custom.css, uofu-theme.css]\n---\n\n\n## Research threads at a glance {auto-animate=true}\n\n<div style=\"height:1em;\"></div>\n\n<div style=\"\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  grid-template-rows: auto auto;\n  gap: 3em;\n  align-items: center;\n  justify-items: center;\n\">\n\n<!-- Top left -->\n<div class=\"fragment\" data-fragment-index=\"1\" style=\"\n  border:2px solid #333;\n  border-radius:999px;\n  padding:1.2em;\n  background:#f5f7fa;\n  text-align:center;\n  font-weight:700;\n  width: 80%;\n\">\nClinical Prediction &<br>Decision Support\n</div>\n\n<!-- Top right -->\n<div class=\"fragment\" data-fragment-index=\"2\" style=\"\n  border:2px solid #333;\n  border-radius:999px;\n  padding:1.2em;\n  background:#f5f7fa;\n  text-align:center;\n  font-weight:700;\n  width: 80%;\n\">\nDesign &<br>Analysis\n</div>\n\n<!-- Bottom center -->\n<div class=\"fragment\" data-fragment-index=\"3\"\n     style=\"grid-column: 1 / span 2; width: 100%; text-align: center;\">\n  <div data-id=\"bayes-core\" style=\"\n    border:2px solid #333;\n    border-radius:999px;\n    padding:1.4em;\n    background:#f5f7fa;\n    text-align:center;\n    font-weight:800;\n    width: 76%;\n    max-width: 820px;\n    white-space: nowrap;\n    margin: 0 auto;\n  \">\n  Complex Bayesian Hierarchical Models in Stan<br>\n  \n  </div>\n</div>\n\n</div>\n\n---\n\n##  {auto-animate=true visibility=\"uncounted\"}\n\n<div style=\"height:1.5em;\"></div>\n\n<div style=\"width: 100%; text-align: center;\">\n\n<div data-id=\"bayes-core\" style=\"\n  border:3px solid #333;\n  border-radius:999px;\n  padding:2em 3em;\n  background:#e8f0ff;\n  text-align:center;\n  font-weight:900;\n  font-size:1.4em;\n  width: 76%;\n  max-width: 820px;\n  white-space: nowrap;\n  margin: 0 auto;\n\">\nComplex Bayesian Hierarchical Models in Stan \n</div>\n\n</div>\n\n::: {.fragment fragment-index=2}\n- Two examples of work in progress:\n  - Stochastic SEIR models that incorporate imperfect **detection** - COVID-19\n  - Early **detection** of call spikes - United Way 211 Calls (Food Insecurity Resources)\n:::\n\n::: {.fragment fragment-index=1}\n::: {.callout-note}\nSEIR models track transitions between susceptible, exposed, infectious, and removed states to represent epidemic dynamics.\n:::\n:::\n\n\n---\n\n## Case study 1: COVID-19 is not perfectly reported\n\n- Latent disease transmission is never directly observed \n- Reported cases reflect testing intensity, reporting practices, and asymptomatic disease\n - Only the sickest got diagnosed with COVID-19 early in the pandemic \n- **Key capability:** separate what is happening from what is observed.\n\n\n---\n\n## Various approaches have been developed to estimate clinical detection rates {}\n\n- **Back-calculation methods** estimate the number of infections from hospitalizations and deaths\n- **Seroprevalence studies** estimate the proportion of the population that has been infected by testing for antibodies\n- **Compartment models** estimate the number of infections from observed cases and the distribution of the incubation period\n    - E.g. SIR (Susceptible-Infectious-Recovered) models\n- **Key Challenge**: identifiability issues arise when trying to estimate both the true number of infections and the detection rate from observed data, especially when testing practices change over time.\n\n---\n\n\n## We propose a novel hierarchical Bayesian solution fit on observed county-level counts of new cases\n\n- Latent SEIR compartmental process for true infections\n  - Approximate binomial observation using a Gaussian process\n- Transmission follows a hierarchical AR(1) process over time\n  - Lay interpretation: transmission this week tends to resemble recent weeks, while still allowing gradual changes across districts.\n- Estimation allows for different start time across health districts\n- Allows an evolving recovery/incubation rate (E->I and I->R transitions) using beta-binomial transition\n  - Use a novel computational solution to estimate these dynamics efficiently in Stan \n\n::: {.fragment}\n**Modeling strategy:** allow flexibility where variability is real.\n:::\n\n---\n\n\n## Estimating an evolving recovery rate and incubation using beta-binomial transitions \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-1-1.gif)\n:::\n:::\n\n\n---\n\n\n## Estimating an evolving transmission rate using a hierarchical AR(1) process\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-2-1.gif)\n:::\n:::\n\n\n---\n\n## Utah COVID-19 dynamics (posterior density)\n\n![](utah_p_dens_020325.png){height=500px}\n\n---\n\n## Utah beta-binomial transition fit\n\n![](utah_120525_bb.png){height=500px}\n\n---\n\n## Case study 2: Can spikes in 211 calls be detected early? \n\n- 211 is a nationwide, free public referral system that responds to >20 million requests for help each year from U.S. residents\n- We have call counts from Utah from 2019 - 2025. \n- Calls are often zero or low volume, but occasionally spike when there are major events (e.g. COVID-19, natural disasters, economic shocks)\n- Can we capture these spikes early to help with resource allocation and response?\n\n---\n\n## How we model the call data\n- Zero-inflated negative binomial (ZINB) model for daily call counts\n  - Lay interpretation: some days truly have no demand, while other days vary widely and can spike.\n- Day-of-week effects included in both the hurdle and count components\n  - Lay interpretation: Mondays and weekends can have different baseline call patterns.\n- Latent intensity evolves through an AR(1) state process over time\n  - Lay interpretation: call demand today is related to recent days, not independent day-to-day.\n- Annual seasonality represented with Fourier harmonics\n  - Lay interpretation: recurring yearly patterns are modeled smoothly rather than with hard cutoffs.\n\n\n::: {.fragment}\n**Modeling strategy:** match distributional assumptions to observed call behavior.\n:::\n\n---\n\n## How early warning works\n\n- Smooth logistic change-point ramps capture medium-term structural shifts \n  - Pre-specified number but estimated using horseshoe priors to allow for flexibility\n  - Lay interpretation: the model allows gradual shifts in demand level but avoids overreacting to noise.\n- Daily shock term captures short-lived departures from baseline\n  - Lay interpretation: unusual surges are flagged when calls jump above expected patterns.\n\n::: {.fragment}\n**Capability:** separate expected temporal structure from transient anomalies.\n:::\n\n---\n\n## Prospective model fitting from Mar 25 to Apr 10, 2020 (COVID-19 example)\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-3-1.gif)\n:::\n:::\n\nOrange dots are observed call counts. Dark grey line and light grey shade are model fit with posterior credible intervals. Green bar near the x-axis represents 90% credible intervals for change-point timing, and the dashed blue line marks the current date.\n\n---\n\n## Prospective model fitting from Mar 25 to Apr 10, 2020 (COVID-19 example)\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-4-1.gif)\n:::\n:::\n\nTop panel overlays raw calls (orange points) with posterior mean and 90% credible interval.\nBottom panel shows posterior kappa points with reference lines at 1.0 and +/-10% (y-axis fixed to 0.5-1.5).\n\n---\n\n\n## Practical decision use is still a work in progress\n\n- Posterior expected calls are compared against latent baseline expectations\n- Kappa values above a certain level indicate anomolous behavior, but thresholds for action are still being determined\n- Tau and ramps can be used to show a systematic shift in call behavior, but how to use this information for decision-making is still being explored\n\n---\n\n## What unifies this work\n\n- Latent-process Bayesian models on count data with temporal dependence\n- Flexible distributions matched to real-world count data\n- Early detection through probabilistic change modeling\n\n\n## Thank you\n\nQuestions or collaborations welcome.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}