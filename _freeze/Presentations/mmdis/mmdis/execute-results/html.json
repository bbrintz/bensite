{
  "hash": "1a250cb3c4c47987b70cb902d2702afa",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Measuring and Mitigating Disparity of Decision-Making Tools\"\nauthor: \"Ben Brintz\"\ninstitute: \"Division of Epidemiology\"\nformat: \n  revealjs:\n    revealjs-plugins: \n        -plugin\n    theme: white\n    incremental: true\n    slideNumber: true  # Slide numbers (optional)\n    transition: fade   # Smooth slide transitions\n    title-slide-background: \"white\" # Ensure title slide background matches your style\n    css: custom.css    # Link to your custom CSS file\n---\n\n\n\n\n## There is some controversy surrounding the eGFR equation {style=\"font-size:.75em;\" auto-animate=true auto-animate-easing=\"ease-in-out\"}\n\n\n::: {.r-hstack}\n  <img src=\"egfr1.gif\" alt=\"GIF 1\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr2.gif\" alt=\"GIF 2\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr3.gif\" alt=\"GIF 3\" style=\"height:160px; width:auto; object-fit:contain;\">\n:::\n\n## There is some controversy surrounding the eGFR equation {style=\"font-size:.75em;\" auto-animate=true auto-animate-easing=\"ease-in-out\" visibility=\"uncounted\"}\n::: {.r-hstack}\n  <img src=\"egfr1.gif\" alt=\"GIF 1\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr2.gif\" alt=\"GIF 2\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr3.gif\" alt=\"GIF 3\" style=\"height:160px; width:auto; object-fit:contain;\">\n:::\n::: {.r-hstack}\n  <img src=\"egfr4.gif\" alt=\"GIF 1\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr5.gif\" alt=\"GIF 2\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr6.gif\" alt=\"GIF 3\" style=\"height:160px; width:auto; object-fit:contain;\">\n:::\n\n## There is some controversy surrounding the eGFR equation {style=\"font-size:.75em;\" auto-animate=true auto-animate-easing=\"ease-in-out\" visibility=\"uncounted\"}\n::: {.r-hstack}\n  <img src=\"egfr1.gif\" alt=\"GIF 1\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr2.gif\" alt=\"GIF 2\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr3.gif\" alt=\"GIF 3\" style=\"height:160px; width:auto; object-fit:contain;\">\n:::\n::: {.r-hstack}\n  <img src=\"egfr4.gif\" alt=\"GIF 1\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr5.gif\" alt=\"GIF 2\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr6.gif\" alt=\"GIF 3\" style=\"height:160px; width:auto; object-fit:contain;\">\n:::\n::: {.r-hstack}\n  <img src=\"egfr7.gif\" alt=\"GIF 1\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr8.gif\" alt=\"GIF 2\" style=\"height:160px; width:auto; object-fit:contain;\">\n  <img src=\"egfr9.gif\" alt=\"GIF 3\" style=\"height:160px; width:auto; object-fit:contain;\">\n:::\n\n## The NKF and ASN have since recommended removal of race from the equation\n::: {.incremental}\n\n- Acknowledged race is a social concept \n    - i.e., it's a system to classify individuals rather than reflect biology\n    - I have heard the biology is more regional than racial \n-  Does removal of race reduce performance of the decision-making tool?\n:::\n\n\n::: {.fragment .fade-up}\n It depends on how you're measuring performance\n:::\n\n\n---\n<div style=\"font-size: 60px; text-align: center;\">Performance metrics are a trade-off </div>\n::: {.cell}\n::: {.cell-output-display}\n![](mmdis_files/figure-revealjs/unnamed-chunk-1-1.png){width=960}\n:::\n:::\n::: {.fragment .fade-in-then-semi-out}\nThe developer can choose to emphasize one metric over another \n:::\n\n::: {.fragment .fade-right}\nAnd the choice of metric could be predictive performance or fairness \n:::\n\n\n## Some fairness metrics are more well known than others\n<style>\n.reveal .fragment {\n  margin-bottom: 5px; /* Adjust this value to reduce space between fragments */\n}\n</style>\n\n::: {.fragment  .highlight-current-blue}\n\\begin{align*}\n\\text{Statistical Parity} &= P(\\widehat{Y}=1|A=a) \\\\\n&= P(\\widehat{Y}=1|A=b)\n\\end{align*}\n:::\n\n::: {.fragment .highlight-current-blue}\n\\begin{align*}\n\\text{Equalized Odds} &= P(\\widehat{Y}=1|A=a,Y=1) \\\\\n&= P(\\widehat{Y}=1|A=b,Y=1)\n\\end{align*}\n:::\n\n::: {.fragment .highlight-current-blue}\n\\begin{align*}\n\\text{Predictive Parity} &= P(Y=1|\\widehat{Y}=1,A=a) \\\\\n&= P(Y=1|\\widehat{Y}=1,A=b)\n\\end{align*}\n:::\n\n::: {.fragment .highlight-current-blue}\n\\begin{align*}\n\\text{Balance for the Positive Class} &= E(S|Y=1,A=a) \\\\ &=E(S|Y=1,A=b)\n\\end{align*}\n:::\n\n## The COMPAS data is a landmark dataset to study algorithmic fairness in recidivism prediction {auto-animate=\"true\"}\n```r\nlibrary(fairness)\n\nhead(compas)\n```\n\n## The COMPAS data is a landmark dataset to study algorithmic fairness in recidivism prediction {auto-animate=\"true\" visibility=\"uncounted\"}\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:left;\"> Two_yr_Recidivism </th>\n   <th style=\"text-align:right;\"> Number_of_Priors </th>\n   <th style=\"text-align:left;\"> Age_Above_FourtyFive </th>\n   <th style=\"text-align:left;\"> Age_Below_TwentyFive </th>\n   <th style=\"text-align:left;\"> Female </th>\n   <th style=\"text-align:left;\"> Misdemeanor </th>\n   <th style=\"text-align:left;\"> ethnicity </th>\n   <th style=\"text-align:right;\"> probability </th>\n   <th style=\"text-align:right;\"> predicted </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> -0.6843578 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> Other </td>\n   <td style=\"text-align:right;\"> 0.3151557 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 2.2668817 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Caucasian </td>\n   <td style=\"text-align:right;\"> 0.8854616 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 7 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> -0.6843578 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> Caucasian </td>\n   <td style=\"text-align:right;\"> 0.2552680 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 11 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> -0.6843578 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> African_American </td>\n   <td style=\"text-align:right;\"> 0.4173908 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 14 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> -0.6843578 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> Hispanic </td>\n   <td style=\"text-align:right;\"> 0.3200982 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 24 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> -0.6843578 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> Other </td>\n   <td style=\"text-align:right;\"> 0.3151557 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n## If you can code, measuring fairness is easy {auto-animate=\"true\"}\n```r\na=compas %>% group_by(Female) %>% summarize(`Statistical Parity`=mean(predicted))\n\nb=compas %>% filter(Two_yr_Recidivism==\"yes\") %>% group_by(Female) %>% summarize(`Equalized Odds`=mean(predicted))\n\nc=compas %>% filter(predicted==1) %>% group_by(Female) %>% summarize('Predictive Parity'=mean(Two_yr_Recidivism==\"yes\"))\n\nd=compas %>% filter(Two_yr_Recidivism==\"yes\") %>% group_by(Female) %>% summarize('Balance for the Positive Class'=mean(probability))\n```\n\n## If you can code, measuring fairness is easy {auto-animate=\"true\"}\n::: {.cell}\n\n```{.r .cell-code}\na=compas %>% group_by(Sex=Female) %>% summarize(`Statistical Parity`=mean(predicted))\n\nb=compas %>% filter(Two_yr_Recidivism==\"yes\") %>% group_by(Female) %>% summarize(`Equalized Odds`=mean(predicted)) %>% select(-Female)\n\nc=compas %>% filter(predicted==1) %>% group_by(Female) %>% summarize('Predictive Parity'=mean(Two_yr_Recidivism==\"yes\"))%>% select(-Female)\n\nd=compas %>% filter(Two_yr_Recidivism==\"yes\") %>% group_by(Female) %>% summarize('Balance for the Positive Class'=mean(probability))%>% select(-Female)\n\ncbind(a,b,c,d) %>% knitr::kable() \n```\n\n::: {.cell-output-display}\n\n\n|Sex    | Statistical Parity| Equalized Odds| Predictive Parity| Balance for the Positive Class|\n|:------|------------------:|--------------:|-----------------:|------------------------------:|\n|Male   |          0.5069041|      0.6794658|         0.6427161|                      0.5902647|\n|Female |          0.2221277|      0.3753027|         0.5938697|                      0.4567142|\n\n\n:::\n:::\n\n## But choosing a metric is hard {auto-animate=\"true\"}\n![](fair_diagram.png)\n\n## But choosing a metric is hard {auto-animate=\"true\" visibility=\"uncounted\"}\n<img src=\"fair_diagram.png\" class=\"zoom-effect\" width=\"100%\">\n",
    "supporting": [
      "mmdis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}